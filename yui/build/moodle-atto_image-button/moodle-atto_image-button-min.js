YUI.add("moodle-atto_image-button",function(c,e){c.namespace("M.atto_image").Util={_isImage:function(e){return 0===e.indexOf("image/")},_getAlignmentClass:function(e){return d.ALIGNSETTINGS+"_"+e},_toggleVisibility:function(e,t,i){e.all(t).setStyle("display",i?"block":"none")},_toggleAriaInvalid:function(t,e,i){e.forEach(function(e){t.all(e).setAttribute("aria-invalid",i)})},_hasErrorUrlField:function(e,t){var i=""===e.one("."+t.INPUTURL).get("value");return this._toggleVisibility(e,"."+t.IMAGEURLWARNING,i),this._toggleAriaInvalid(e,["."+t.INPUTURL],i),i},_hasErrorAltField:function(e,t){var i=e.one("."+t.INPUTALT).get("value"),n=e.one("."+t.IMAGEPRESENTATION).get("checked"),i=""===i&&!n;return this._toggleVisibility(e,"."+t.IMAGEALTWARNING,i),this._toggleAriaInvalid(e,["."+t.INPUTALT,"."+t.IMAGEPRESENTATION],i),i}},c.namespace("M.atto_image").AltGenerator={generateAltText:function(e,t){return new Promise(function(a,s){c.io(M.cfg.wwwroot+"/lib/editor/atto/plugins/image/generate_alt.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:"sesskey="+M.cfg.sesskey+"&imageurl="+encodeURIComponent(e)+"&language="+encodeURIComponent(t),on:{success:function(e,t){try{var i=JSON.parse(t.responseText);i.alttext?a(i.alttext):s("No alt text generated")}catch(n){s("Failed to parse server response: "+t.responseText)}},failure:function(e,t){s("Failed to generate alt text: "+t.statusText)}}})})}};var d={RESPONSIVE:"img-fluid",INPUTALIGNMENT:"atto_image_alignment",INPUTALT:"atto_image_altentry",INPUTHEIGHT:"atto_image_heightentry",INPUTSUBMIT:"atto_image_urlentrysubmit",INPUTURL:"atto_image_urlentry",INPUTSIZE:"atto_image_size",INPUTWIDTH:"atto_image_widthentry",IMAGEALTWARNING:"atto_image_altwarning",IMAGEURLWARNING:"atto_image_urlwarning",IMAGEBROWSER:"openimagebrowser",IMAGEPRESENTATION:"atto_image_presentation",INPUTCONSTRAIN:"atto_image_constrain",INPUTCUSTOMSTYLE:"atto_image_customstyle",IMAGEPREVIEW:"atto_image_preview",IMAGEPREVIEWBOX:"atto_image_preview_box",ALIGNSETTINGS:"atto_image_button",GENERATEALT:"atto_image_generate_alt",LANGUAGESELECTOR:"atto_image_language_selector"},a={URL:"urlentry",ALT:"altentry"},t={INPUTURL:"."+d.INPUTURL},s=[{name:"verticalAlign",str:"alignment_top",value:"text-top",margin:"0 0.5em"},{name:"verticalAlign",str:"alignment_middle",value:"middle",margin:"0 0.5em"},{name:"verticalAlign",str:"alignment_bottom",value:"text-bottom",margin:"0 0.5em",isDefault:!0},{name:"float",str:"alignment_left",value:"left",margin:"0 0.5em 0 0"},{name:"float",str:"alignment_right",value:"right",margin:"0 0 0 0.5em"}],o=160,l=160,m=/\d+%/,u="atto_image",_='<img src="{{url}}" alt="{{alt}}" {{#if width}}width="{{width}}" {{/if}}{{#if height}}height="{{height}}" {{/if}}{{#if presentation}}role="presentation" {{/if}}{{#if customstyle}}style="{{customstyle}}" {{/if}}{{#if classlist}}class="{{classlist}}" {{/if}}{{#if id}}id="{{id}}" {{/if}}/>';c.namespace("M.atto_image").Button=c.Base.create("button",c.M.editor_atto.EditorPlugin,[],{_currentSelection:null,_selectedImage:null,_form:null,_rawImageDimensions:null,initializer:function(){this.addButton({icon:"e/insert_edit_image",callback:this._displayDialogue,tags:"img",tagMatchRequiresAll:!1}),this.editor.delegate("dblclick",this._displayDialogue,"img",this),this.editor.delegate("click",this._handleClick,"img",this),this.editor.on("paste",this._handlePaste,this),this.editor.on("drop",this._handleDragDrop,this),this.editor.on("dragover",function(e){e.preventDefault()},this),this.editor.on("dragenter",function(e){e.preventDefault()},this),this._loadLanguages()},_handleDragDrop:function(e){e._event&&e._event.dataTransfer&&this._handlePasteOrDropHelper(e,e._event.dataTransfer)},_handlePaste:function(e){return!e._event||!e._event.clipboardData||this._handlePasteOrDropHelper(e,e._event.clipboardData)},_handlePasteOrDropHelper:function(e,t){for(var i,n=t.items,a=!1,s=0;s<n.length;s++)"file"===(i=n[s]).kind&&this._isImage(i.type)&&(this._uploadImage(i.getAsFile()),a=!0);a&&e.preventDefault()},_isImage:function(e){return 0===e.indexOf("image/")},_uploadImage:function(e){var t,i,n,a,s,o,l,r=this,g=this.get("host"),h=c.Handlebars.compile(_);for(g.saveSelection(),require(["core_form/events"],function(e){e.notifyUploadStarted(r.editor.get("id"))}),s=(t=g.get("filepickeroptions").image).savepath===undefined?"/":t.savepath,i=new FormData,a=new XMLHttpRequest,o=Object.keys(t.repositories),i.append("repo_upload_file",e),i.append("itemid",t.itemid),l=0;l<o.length;l++)if("upload"===t.repositories[o[l]].type){i.append("repo_id",t.repositories[o[l]].id);break}i.append("env",t.env),i.append("sesskey",M.cfg.sesskey),i.append("client_id",t.client_id),i.append("savepath",s),i.append("ctx_id",t.context.id),e=(new Date).getTime(),n="moodleimage_"+Math.round(1e5*Math.random())+"-"+e,g.focus(),g.restoreSelection(),s=h({url:M.util.image_url("i/loading_small","moodle"),alt:M.util.get_string("uploading",u),id:n}),g.insertContentAtFocusPoint(s),r.markUpdated(),a.onreadystatechange=function(){var e,t,i=r.editor.one("#"+n);if(4===a.readyState){if(200===a.status){if(e=JSON.parse(a.responseText)){if(e.error)throw i&&i.remove(!0),require(["core_form/events"],function(e){e.notifyUploadCompleted(r.editor.get("id"))}),new M.core.ajaxException(e);(t=e).event&&"fileexists"===e.event&&(t=e.newfile),e=h({url:t.url,presentation:!0,classlist:d.RESPONSIVE}),t=c.Node.create(e),i?i.replace(t):r.editor.appendChild(t),r.markUpdated()}}else c.use("moodle-core-notification-alert",function(){require(["core_form/events"],function(e){e.notifyUploadCompleted(r.editor.get("id"))}),new M.core.alert({message:M.util.get_string("servererror","moodle")})}),i&&i.remove(!0);require(["core_form/events"],function(e){e.notifyUploadCompleted(r.editor.get("id"))})}},a.open("POST",M.cfg.wwwroot+"/repository/repository_ajax.php?action=upload",!0),a.send(i)},_handleClick:function(e){e=e.target,e=this.get("host").getSelectionFromNode(e);this.get("host").getSelection()!==e&&this.get("host"
).setSelection(e)},_displayDialogue:function(){var e;this._currentSelection=this.get("host").getSelection(),!1!==this._currentSelection&&(this._rawImageDimensions=null,console.log("Languages before setting dialogue content:",this._getLanguages()),(e=this.getDialogue({headerContent:M.util.get_string("imageproperties",u),width:"auto",focusAfterHide:!0,focusOnShowSelector:t.INPUTURL})).get("boundingBox").setStyle("maxWidth","90%"),e.set("bodyContent",this._getDialogueContent()).show())},_loadPreviewImage:function(e){var t=new Image,n=this;t.onerror=function(){n._form.one("."+d.IMAGEPREVIEW).setStyles({display:"none"}),n.getDialogue().centerDialogue()},t.onload=function(){var e,t,i;n._rawImageDimensions={width:this.width||o,height:this.height||l},""===(t=(e=n._form.one("."+d.INPUTWIDTH)).get("value"))&&(e.set("value",n._rawImageDimensions.width),t=""+n._rawImageDimensions.width),""===(i=(e=n._form.one("."+d.INPUTHEIGHT)).get("value"))&&(e.set("value",n._rawImageDimensions.height),i=""+n._rawImageDimensions.height),(e=n._form.one("."+d.IMAGEPREVIEW)).setAttribute("src",this.src),e.setStyles({display:"inline"}),e=n._form.one("."+d.INPUTCONSTRAIN),t.match(m)&&i.match(m)?e.set("checked",t===i):0===this.width||0===this.height?e.set("disabled","disabled"):(t=Math.round(1e3*parseInt(t,10)/this.width),i=Math.round(1e3*parseInt(i,10)/this.height),e.set("checked",t===i)),n._autoAdjustSize(n),n.getDialogue().centerDialogue()},t.src=e},_getDialogueContent:function(){var e=c.Handlebars.compile('<form class="atto_form"><div style="display:none" role="alert" class="alert alert-warning mb-1 {{CSS.IMAGEURLWARNING}}"><label for="{{elementid}}_{{CSS.INPUTURL}}">{{get_string "imageurlrequired" component}}</label></div>{{#if showFilepicker}}<div class="mb-1"><label for="{{elementid}}_{{CSS.INPUTURL}}">{{get_string "enterurl" component}}</label><div class="input-group input-append w-100"><input name="{{FORMNAMES.URL}}" class="form-control {{CSS.INPUTURL}}" type="url" id="{{elementid}}_{{CSS.INPUTURL}}" size="32"/><span class="input-group-append"><button class="btn btn-secondary {{CSS.IMAGEBROWSER}}" type="button">{{get_string "browserepositories" component}}</button></span></div></div>{{else}}<div class="mb-1"><label for="{{elementid}}_{{CSS.INPUTURL}}">{{get_string "enterurl" component}}</label><input name="{{FORMNAMES.URL}}" class="form-control fullwidth {{CSS.INPUTURL}}" type="url" id="{{elementid}}_{{CSS.INPUTURL}}" size="32"/></div>{{/if}}<div style="display:none" role="alert" class="alert alert-warning mb-1 {{CSS.IMAGEALTWARNING}}"><label for="{{elementid}}_{{CSS.INPUTALT}}">{{get_string "presentationoraltrequired" component}}</label></div><div class="mb-1"><label for="{{elementid}}_{{CSS.INPUTALT}}">{{get_string "enteralt" component}}</label><textarea class="form-control fullwidth {{CSS.INPUTALT}}" id="{{elementid}}_{{CSS.INPUTALT}}" name="{{FORMNAMES.ALT}}" maxlength="125"></textarea><div class="mb-1"><label for="{{elementid}}_{{CSS.LANGUAGESELECTOR}}">{{get_string "select_language" component}}</label><select class="form-control {{CSS.LANGUAGESELECTOR}}" id="{{elementid}}_{{CSS.LANGUAGESELECTOR}}">{{#each languages}}<option value="{{code}}">{{name}}</option>{{/each}}</select></div><div class="mb-1"><button class="btn btn-secondary {{CSS.GENERATEALT}}" type="button">{{get_string "generatealt" component}} ({{currentLanguage}})</button></div><div id="the-count" class="d-flex justify-content-end small"><span id="currentcount">0</span><span id="maximumcount"> / 125</span></div><div class="form-check"><input type="checkbox" class="form-check-input {{CSS.IMAGEPRESENTATION}}" id="{{elementid}}_{{CSS.IMAGEPRESENTATION}}"/><label class="form-check-label" for="{{elementid}}_{{CSS.IMAGEPRESENTATION}}">{{get_string "presentation" component}}</label></div></div><div class="mb-1"><label class="" for="{{elementid}}_{{CSS.INPUTSIZE}}">{{get_string "size" component}}</label><div id="{{elementid}}_{{CSS.INPUTSIZE}}" class="d-flex flex-wrap align-items-center {{CSS.INPUTSIZE}}"><label class="accesshide" for="{{elementid}}_{{CSS.INPUTWIDTH}}">{{get_string "width" component}}</label><input type="text" class="form-control w-auto mr-1 input-mini {{CSS.INPUTWIDTH}}" id="{{elementid}}_{{CSS.INPUTWIDTH}}" size="4"/> x<label class="accesshide" for="{{elementid}}_{{CSS.INPUTHEIGHT}}">{{get_string "height" component}}</label><input type="text" class="form-control w-auto ml-1 input-mini {{CSS.INPUTHEIGHT}}" id="{{elementid}}_{{CSS.INPUTHEIGHT}}" size="4"/><div class="form-check ml-2"><input type="checkbox" class="form-check-input {{CSS.INPUTCONSTRAIN}}" id="{{elementid}}_{{CSS.INPUTCONSTRAIN}}"/><label class="form-check-label" for="{{elementid}}_{{CSS.INPUTCONSTRAIN}}">{{get_string "constrain" component}}</label></div></div></div><div class="d-flex flex-wrap align-items-center mb-1"><label class="mb-0" for="{{elementid}}_{{CSS.INPUTALIGNMENT}}">{{get_string "alignment" component}}</label><select class="custom-select ml-2 {{CSS.INPUTALIGNMENT}}" id="{{elementid}}_{{CSS.INPUTALIGNMENT}}">{{#each alignments}}<option value="{{value}}">{{get_string str ../component}}</option>{{/each}}</select></div><input type="hidden" class="{{CSS.INPUTCUSTOMSTYLE}}"/><br/><div class="mdl-align"><div class="{{CSS.IMAGEPREVIEWBOX}}"><img class="{{CSS.IMAGEPREVIEW}}" alt="" style="display: none;"/></div><button class="btn btn-secondary {{CSS.INPUTSUBMIT}}" type="submit">{{get_string "saveimage" component}}</button></div></form>'),t=this.get("host").canShowFilepicker("image"),i=this._getLanguages(),n=0<i.length?i[0].code.toUpperCase():"EN",i=c.Node.create(e({elementid:this.get("host").get("elementid"),CSS:d,FORMNAMES:a,component:u,showFilepicker:t,alignments:s,languages:i,currentLanguage:n}));return this._form=i,this._applyImageProperties(this._form),this._addEventListeners(),this._form.one("."+d.INPUTURL).on("blur",this._urlChanged,this),this._form.one("."+d.INPUTURL).on("change",this._hasErrorUrlField,this),this._form.one("."+d.IMAGEPRESENTATION).on(
"change",this._hasErrorAltField,this),this._form.one("."+d.INPUTALT).on("blur",this._hasErrorAltField,this),this._form.one("."+d.INPUTWIDTH).on("blur",this._autoAdjustSize,this),this._form.one("."+d.INPUTHEIGHT).on("blur",this._autoAdjustSize,this,!0),this._form.one("."+d.INPUTCONSTRAIN).on("change",function(e){e.target.get("checked")&&this._autoAdjustSize(e)},this),this._form.one("."+d.INPUTSUBMIT).on("click",this._setImage,this),t&&this._form.one("."+d.IMAGEBROWSER).on("click",function(){this.get("host").showFilepicker("image",this._filepickerCallback,this)},this),this._form.one("."+d.INPUTALT).on("keyup",this._handleKeyup,this),this._form.one("."+d.INPUTALT).setAttribute("placeholder","Enter manually "),(n=this._form.one("."+d.LANGUAGESELECTOR))&&n.on("change",this._updateGenerateButtonLabel,this),this._form=i,this._applyLanguageSelection(),i},_applyLanguageSelection:function(){var e=this._form.one("."+d.LANGUAGESELECTOR),t=this._form.one("."+d.GENERATEALT);e&&t&&e.on("change",function(e){e=e.target.get("value").toUpperCase();t.set("text",M.util.get_string("generatealt",u)+" ("+e+")")})},_addEventListeners:function(){this._form.one("."+d.INPUTURL).on("blur",this._urlChanged,this),this._form.one("."+d.INPUTURL).on("change",this._hasErrorUrlField,this),this._form.one("."+d.IMAGEPRESENTATION).on("change",this._hasErrorAltField,this),this._form.one("."+d.INPUTALT).on("blur",this._hasErrorAltField,this),this._form.one("."+d.INPUTWIDTH).on("blur",this._autoAdjustSize,this),this._form.one("."+d.INPUTHEIGHT).on("blur",this._autoAdjustSize,this,!0),this._form.one("."+d.GENERATEALT).on("click",this._generateAltText,this),this._form.one("."+d.INPUTCONSTRAIN).on("change",function(e){e.target.get("checked")&&this._autoAdjustSize(e)},this),this._form.one("."+d.INPUTSUBMIT).on("click",this._setImage,this),this.get("host").canShowFilepicker("image")&&this._form.one("."+d.IMAGEBROWSER).on("click",function(){this.get("host").showFilepicker("image",this._filepickerCallback,this)},this),this._form.one("."+d.INPUTALT).on("keyup",this._handleKeyup,this)},_loadLanguages:function(){var a=this,e=M.cfg.wwwroot+"/lib/editor/atto/plugins/image/generate_alt.php?action=get_languages&sesskey="+M.cfg.sesskey;c.io(e,{method:"GET",on:{success:function(e,t){try{var i=JSON.parse(t.responseText);i.languages?(a.languages=i.languages,console.log("Languages loaded:",a.languages)):console.error("No languages found in the response")}catch(n){console.error("Failed to parse language data:",n)}},failure:function(e,t){console.error("Failed to load languages:",t.statusText)}}})},_getLanguages:function(){return this.languages||[{code:"en",name:"English"}]},_updateGenerateButtonLabel:function(){var e=this._form.one("."+d.LANGUAGESELECTOR),t=this._form.one("."+d.GENERATEALT);e&&t&&t.set("text",M.util.get_string("generatealt","atto_image")+" ("+e.get("value").toUpperCase()+")")},_generateAltText:function(e){var t,i;e.preventDefault(),t=this._form.one("."+d.INPUTALT),e=this._form.one("."+d.INPUTURL),i=this._form.one("."+d.LANGUAGESELECTOR),e=e.get("value"),i=i.get("value"),e?(t.set("value","Generating alt text..."),this._handleKeyup(),c.M.atto_image.AltGenerator.generateAltText(e,i).then(function(e){t.set("value",e),this._handleKeyup()}.bind(this))["catch"](function(e){console.error("Failed to generate alt text:",e),t.set("value","Error: "+e),this._handleKeyup()}.bind(this))):(t.set("value","Please provide an image URL first"),this._handleKeyup())},_autoAdjustSize:function(e,t){var i,n,a,s,o,l,r,g,h,u;t=t||!1,i=this._form.one("."+d.INPUTWIDTH),n="width",a=this._form.one("."+d.INPUTHEIGHT),s="height",u=this._form.one("."+d.INPUTCONSTRAIN),o=i.get("value"),l=a.get("value"),r=this._form.one("."+d.IMAGEPREVIEW),this._rawImageDimensions&&(""===o&&(o=this._rawImageDimensions[n],i.set("value",o),o=i.get("value")),r.setStyles({width:null,height:null}),u.get("checked")?(t&&(u=i,i=a,a=u,u=n,n=s,s=u,u=o,o=l,l=u),o.match(m)?(l=o,g=parseInt(o,10),h=this._rawImageDimensions.width/100*g,r.setStyle("width",h),h=this._rawImageDimensions.height/100*g,r.setStyle("height",h)):(l=Math.round(o/this._rawImageDimensions[n]*this._rawImageDimensions[s]),t?r.setStyles({width:l,height:o}):r.setStyles({width:o,height:l})),a.set("value",l)):(o.match(m)?(g=parseInt(o,10),h=this._rawImageDimensions.width/100*g,r.setStyle("width",h+"px")):r.setStyle("width",o+"px"),l.match(m)?(g=parseInt(l,10),h=this._rawImageDimensions.height/100*g,r.setStyle("height",h+"px")):r.setStyle("height",l+"px")))},_filepickerCallback:function(e){""!==e.url&&(this._form.one("."+d.INPUTURL).set("value",e.url),this._form.one("."+d.INPUTWIDTH).set("value",""),this._form.one("."+d.INPUTHEIGHT).set("value",""),this._loadPreviewImage(e.url))},_applyImageProperties:function(t){var e=this._getSelectedImageProperties(),i=t.one("."+d.IMAGEPREVIEW);!1===e?(i.setStyle("display","none"),s.some(function(e){return!!e.isDefault&&(t.one("."+d.INPUTALIGNMENT).set("value",e.value),!0)},this)):(e.align&&t.one("."+d.INPUTALIGNMENT).set("value",e.align),e.customstyle&&t.one("."+d.INPUTCUSTOMSTYLE).set("value",e.customstyle),e.width&&t.one("."+d.INPUTWIDTH).set("value",e.width),e.height&&t.one("."+d.INPUTHEIGHT).set("value",e.height),e.alt&&t.one("."+d.INPUTALT).set("value",e.alt),e.src&&(t.one("."+d.INPUTURL).set("value",e.src),this._loadPreviewImage(e.src)),e.presentation&&t.one("."+d.IMAGEPRESENTATION).set("checked","checked"),this._autoAdjustSize())},_getSelectedImageProperties:function(){var e,t,i={src:null,alt:null,width:null,height:null,align:"",presentation:!1},n=this.get("host").getSelectedNodes();return(n=n&&n.filter("img"))&&n.size()?(n=this._removeLegacyAlignment(n.item(0)),t=(this._selectedImage=n).getAttribute("style"),i.customstyle=t,(t=n.getAttribute("width")).match(m)||(t=parseInt(t,10)),(e=n.getAttribute("height")).match(m)||(e=parseInt(e,10)),0!==t&&(i.width=t),0!==e&&(i.height=e),this._getAlignmentPropeties(n,i),i.src=n.getAttribute("src"),i.alt=n.getAttribute("alt")||"",
i.presentation="presentation"===n.get("role"),i):(this._selectedImage=null,!1)},_getAlignmentPropeties:function(i,n){var a;!s.some(function(e){var t=this._getAlignmentClass(e.value);return i.hasClass(t)?(n.align=e.value,!0):(e.isDefault&&(a=e.value),!1)},this)&&a&&(n.align=a)},_urlChanged:function(){var e=this._form.one("."+d.INPUTURL);""!==e.get("value")&&this._loadPreviewImage(e.get("value"))},_setImage:function(e){var t=this._form,i=t.one("."+d.INPUTURL).get("value"),n=t.one("."+d.INPUTALT).get("value"),a=t.one("."+d.INPUTWIDTH).get("value"),s=t.one("."+d.INPUTHEIGHT).get("value"),o=this._getAlignmentClass(t.one("."+d.INPUTALIGNMENT).get("value")),l=t.one("."+d.IMAGEPRESENTATION).get("checked"),r=t.one("."+d.INPUTCONSTRAIN).get("checked"),g=t.one("."+d.INPUTCUSTOMSTYLE).get("value"),h=[],u=this.get("host");if(e.preventDefault(),!this._updateWarning()){if(u.focus(),""!==i){if(this._selectedImage?u.setSelection(u.getSelectionFromNode(this._selectedImage)):u.setSelection(this._currentSelection),r&&h.push(d.RESPONSIVE),h.push(o),!a.match(m)&&isNaN(parseInt(a,10)))return void t.one("."+d.INPUTWIDTH).focus();if(!s.match(m)&&isNaN(parseInt(s,10)))return void t.one("."+d.INPUTHEIGHT).focus();e=c.Handlebars.compile(_)({url:i,alt:n,width:a,height:s,presentation:l,customstyle:g,classlist:h.join(" ")}),this.get("host").insertContentAtFocusPoint(e),this.markUpdated()}this.getDialogue({focusAfterHide:null}).hide()}},_removeLegacyAlignment:function(i){return i.getStyle("margin")&&s.some(function(e){var t;return i.getStyle(e.name)===e.value&&((t=c.Node.create("<div>")).setStyle("margin",e.margin),i.getStyle("margin")===t.getStyle("margin"))&&(i.addClass(this._getAlignmentClass(e.value)),i.setStyle(e.name,null),i.setStyle("margin",null),!0)},this),i},_getAlignmentClass:function(e){return c.M.atto_image.Util._getAlignmentClass(e)},_toggleVisibility:function(e,t){c.M.atto_image.Util._toggleVisibility(this._form,e,t)},_toggleAriaInvalid:function(e,t){c.M.atto_image.Util._toggleAriaInvalid(this._form,e,t)},_hasErrorUrlField:function(){return c.M.atto_image.Util._hasErrorUrlField(this._form,d)},_hasErrorAltField:function(){return c.M.atto_image.Util._hasErrorAltField(this._form,d)},_updateWarning:function(){var e=this._hasErrorUrlField(),t=this._hasErrorAltField(),e=e||t;return this.getDialogue().centerDialogue(),e},_handleKeyup:function(){var e=this._form,t=e.one("."+d.INPUTALT).get("value").length;e.one("#currentcount").setHTML(t)}})},"@VERSION@",{requires:["moodle-editor_atto-plugin"]});